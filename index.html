<!DOCTYPE html><html><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Particle Nebula | Interactive Space Simulation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            overflow: hidden;
            background: #000;
            color: #fff;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 600px;
            margin: 0 auto;
            padding: 2rem;
            text-align: center;
            pointer-events: none;
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 10px rgba(79, 172, 254, 0.3);
        }

        p {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 2rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .controls-panel {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 10;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
            padding: 15px;
            width: 300px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            pointer-events: all;
        }

        .control-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #fff;
            font-size: 0.9rem;
        }

        input[type="range"] {
            width: 100%;
            height: 5px;
            -webkit-appearance: none;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #4facfe;
            cursor: pointer;
        }

        select {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            font-size: 0.9rem;
        }

        .theme-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .theme-btn {
            flex: 1;
            padding: 5px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .theme-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .theme-btn.orion {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
        }

        .theme-btn.helix {
            background: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%);
            color: white;
        }

        .theme-btn.crab {
            background: linear-gradient(135deg, #4776e6 0%, #8e54e9 100%);
            color: white;
        }

        .info-text {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 5px;
        }

        .copyright {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 10;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.8rem;
        }

        @media (max-width: 768px) {
            .controls-panel {
                width: calc(100% - 40px);
                bottom: 10px;
                left: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            p {
                font-size: 1rem;
            }
        }
    </style>
    <!-- Core Three.js library -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

    <base target="_self">
</head>
<body>
    <div id="canvas-container"></div>
    
    <div class="hero-content">
        <h1>Cosmic Particle Nebula</h1>
        <p>Explore the beauty of celestial mechanics with this interactive particle simulation. Adjust the gravitational forces and watch as particles form swirling nebula patterns around your cursor.</p>
    </div>
    
    <div class="controls-panel">
        <div class="control-group">
            <label for="gravity">Gravitational Pull</label>
            <input type="range" id="gravity" min="0.1" max="2" step="0.1" value="1">
            <div class="info-text">Adjust the strength of attraction between particles</div>
        </div>
        
        <div class="control-group">
            <label for="density">Nebula Density</label>
            <input type="range" id="density" min="500" max="2000" step="100" value="1000">
            <div class="info-text">Control the number of particles in the simulation</div>
        </div>
        
        <div class="control-group">
            <label for="glow">Glow Intensity</label>
            <input type="range" id="glow" min="0" max="2" step="0.1" value="1">
            <div class="info-text">Adjust the luminous halo around particles</div>
        </div>
        
        <div class="control-group">
            <label for="theme">Nebula Theme</label>
            <div class="theme-buttons">
                <button class="theme-btn orion">Orion</button>
                <button class="theme-btn helix">Helix</button>
                <button class="theme-btn crab">Crab</button>
            </div>
        </div>
    </div>
    
    <div class="copyright">Â© 2025 Cosmic Particle Nebula</div>

    <script>
        // Three.js variables
        let scene, camera, renderer;
        let particles, particleGeometry, particleMaterial;
        let mouseX = 0, mouseY = 0;
        let particleCount = 1000;
        let particlePositions = [];
        let particleVelocities = [];
        let particleSizes = [];
        let particleColors = [];
        let params = {
            gravity: 1,
            density: 1000,
            glow: 1,
            theme: 'orion'
        };
        
        // Initialize the scene
        function init() {
            // Create scene
            scene = new THREE.Scene();
            
            // Create camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 30;
            
            // Create renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setClearColor(0x000000, 1);
            document.getElementById('canvas-container').appendChild(renderer.domElement);
            
            // SIMPLIFIED: Remove post-processing to avoid module loading issues
            // Just create particles without bloom effect
            createParticles();
            
            // Add event listeners
            window.addEventListener('resize', onWindowResize);
            document.addEventListener('mousemove', onMouseMove);
            
            // UI controls
            document.getElementById('gravity').addEventListener('input', updateParams);
            document.getElementById('density').addEventListener('input', updateParams);
            document.getElementById('glow').addEventListener('input', updateParams);
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.addEventListener('click', changeTheme);
            });
            
            // Start animation loop
            animate();
        }
        
        // Create particle system
        function createParticles() {
            // Clear existing particles if any
            if (particles) {
                scene.remove(particles);
                if (particleGeometry) particleGeometry.dispose();
                if (particleMaterial) particleMaterial.dispose();
            }
            
            particleCount = params.density;
            particlePositions = new Float32Array(particleCount * 3);
            particleVelocities = new Array(particleCount);
            particleSizes = new Float32Array(particleCount);
            particleColors = new Float32Array(particleCount * 3);
            
            // Set initial positions and velocities
            for (let i = 0; i < particleCount; i++) {
                // Random position in a sphere
                const radius = 20 * Math.random();
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.acos(2 * Math.random() - 1);
                
                particlePositions[i * 3] = radius * Math.sin(phi) * Math.cos(theta);
                particlePositions[i * 3 + 1] = radius * Math.sin(phi) * Math.sin(theta);
                particlePositions[i * 3 + 2] = radius * Math.cos(phi);
                
                // Initial velocities for orbital motion
                const speed = 0.02 + Math.random() * 0.03;
                particleVelocities[i] = new THREE.Vector3(
                    -particlePositions[i * 3 + 1] * speed,
                    particlePositions[i * 3] * speed,
                    0
                );
                
                // Random sizes
                particleSizes[i] = 1 + Math.random() * 4;
                
                // Colors based on theme
                setParticleColors(i);
            }
            
            // Create geometry
            particleGeometry = new THREE.BufferGeometry();
            particleGeometry.setAttribute('position', new THREE.BufferAttribute(particlePositions, 3));
            particleGeometry.setAttribute('color', new THREE.BufferAttribute(particleColors, 3));
            
            // Create material with adjusted size based on glow parameter
            particleMaterial = new THREE.PointsMaterial({
                size: 2 * params.glow,
                vertexColors: true,
                transparent: true,
                opacity: 0.8,
                blending: THREE.AdditiveBlending,
                sizeAttenuation: true
            });
            
            // Create particle system
            particles = new THREE.Points(particleGeometry, particleMaterial);
            scene.add(particles);
        }
        
        // Set particle colors based on theme
        function setParticleColors(i) {
            const r = i / particleCount;
            
            switch(params.theme) {
                case 'orion':
                    // Blue to red gradient
                    particleColors[i * 3] = 0.1 + 0.9 * r;
                    particleColors[i * 3 + 1] = 0.2 * (1 - r);
                    particleColors[i * 3 + 2] = 0.5 + 0.5 * (1 - r);
                    break;
                case 'helix':
                    // Teal to orange gradient
                    particleColors[i * 3] = 0.2 + 0.8 * r;
                    particleColors[i * 3 + 1] = 0.5 + 0.3 * (1 - r);
                    particleColors[i * 3 + 2] = 0.5 * r;
                    break;
                case 'crab':
                    // Purple to gold gradient
                    particleColors[i * 3] = 0.5 + 0.5 * r;
                    particleColors[i * 3 + 1] = 0.2 * (1 - r);
                    particleColors[i * 3 + 2] = 0.7 - 0.2 * r;
                    break;
            }
            
            // Add some randomness to colors
            particleColors[i * 3] += (Math.random() - 0.5) * 0.2;
            particleColors[i * 3 + 1] += (Math.random() - 0.5) * 0.2;
            particleColors[i * 3 + 2] += (Math.random() - 0.5) * 0.2;
            
            // Clamp values between 0 and 1
            particleColors[i * 3] = Math.max(0, Math.min(1, particleColors[i * 3]));
            particleColors[i * 3 + 1] = Math.max(0, Math.min(1, particleColors[i * 3 + 1]));
            particleColors[i * 3 + 2] = Math.max(0, Math.min(1, particleColors[i * 3 + 2]));
        }
        
        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            
            // Update particle positions
            const positions = particles.geometry.attributes.position.array;
            
            for (let i = 0; i < particleCount; i++) {
                const ix = i * 3;
                const iy = i * 3 + 1;
                const iz = i * 3 + 2;
                
                // Central gravity
                const dx = -positions[ix];
                const dy = -positions[iy];
                const dz = -positions[iz];
                const dist = Math.sqrt(dx * dx + dy * dy + dz * dz);
                
                // Normalize and scale by gravity
                const force = 0.0001 * params.gravity / (dist * dist + 0.1);
                particleVelocities[i].x += dx * force;
                particleVelocities[i].y += dy * force;
                particleVelocities[i].z += dz * force;
                
                // Mouse attraction (black hole effect)
                const mouseDist = Math.sqrt(
                    Math.pow(positions[ix] - mouseX, 2) + 
                    Math.pow(positions[iy] - mouseY, 2)
                );
                
                if (mouseDist < 10) {
                    const mouseForce = 0.1 * params.gravity / (mouseDist + 0.1);
                    particleVelocities[i].x += (mouseX - positions[ix]) * mouseForce;
                    particleVelocities[i].y += (mouseY - positions[iy]) * mouseForce;
                }
                
                // Apply velocity
                positions[ix] += particleVelocities[i].x;
                positions[iy] += particleVelocities[i].y;
                positions[iz] += particleVelocities[i].z;
                
                // Damping
                particleVelocities[i].multiplyScalar(0.99);
            }
            
            // Update geometry
            particles.geometry.attributes.position.needsUpdate = true;
            
            // Rotate camera slightly
            camera.position.x = 30 * Math.sin(Date.now() * 0.0001);
            camera.position.z = 30 * Math.cos(Date.now() * 0.0001);
            camera.lookAt(0, 0, 0);
            
            // Render
            renderer.render(scene, camera);
        }
        
        // Handle window resize
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        // Track mouse position
        function onMouseMove(event) {
            // Convert mouse position to normalized device coordinates (-1 to +1)
            mouseX = (event.clientX / window.innerWidth) * 2 - 1;
            mouseY = -(event.clientY / window.innerHeight) * 2 + 1;
            
            // Scale to scene dimensions
            mouseX *= 30;
            mouseY *= 30;
        }
        
        // Update parameters from UI
        function updateParams() {
            params.gravity = parseFloat(document.getElementById('gravity').value);
            params.density = parseInt(document.getElementById('density').value);
            params.glow = parseFloat(document.getElementById('glow').value);
            
            // Update particle size based on glow intensity
            if (particleMaterial) {
                particleMaterial.size = 2 * params.glow;
            }
            
            // Recreate particles if density changed
            if (params.density !== particleCount) {
                createParticles();
            }
        }
        
        // Change color theme
        function changeTheme(e) {
            params.theme = e.target.classList.contains('orion') ? 'orion' : 
                           e.target.classList.contains('helix') ? 'helix' : 'crab';
            
            // Update all particle colors
            for (let i = 0; i < particleCount; i++) {
                setParticleColors(i);
            }
            
            // Update geometry
            particles.geometry.attributes.color.needsUpdate = true;
        }
        
        // Start the application
        init();
    </script>

</body></html>